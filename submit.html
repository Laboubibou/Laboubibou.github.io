<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Soumettre une Run - Riders Republic</title>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #0d0f10;
            --surface: #15181b;
            --text: #e8ecef;
            --brand: #f1ff00;
            --accent: #21c9b6;
        }
        
        body {
            margin: 0;
            padding: 0;
            background: var(--bg);
            color: var(--text);
            font-family: 'Montserrat', sans-serif;
            min-height: 100vh;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
        }

        .header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .logo {
            width: 80px;
            height: 80px;
            object-fit: contain;
        }

        h1 {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 2.5rem;
            color: var(--brand);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        select, input {
            width: 100%;
            padding: 0.8rem;
            border-radius: 8px;
            background: var(--surface);
            border: 1px solid #333;
            color: var(--text);
            font-size: 1rem;
        }

        .time-container {
            display: none;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            margin-top: 1rem;
        }

        .time-container.visible {
            display: grid;
        }

        .time-field {
            text-align: center;
        }

        .time-field input {
            text-align: center;
            font-size: 1.5rem;
            padding: 1rem;
        }

        .time-label {
            font-size: 1.2rem;
            color: var(--brand);
            margin-bottom: 0.5rem;
            font-weight: bold;
        }

        button {
            width: 100%;
            padding: 1rem;
            background: var(--brand);
            border: none;
            border-radius: 8px;
            color: var(--bg);
            font-weight: bold;
            font-size: 1.1rem;
            cursor: pointer;
            margin-top: 2rem;
        }

        .back-link {
            display: block;
            text-align: center;
            margin-top: 1rem;
            color: var(--accent);
            text-decoration: none;
        }

        .player-info {
            background: var(--surface);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            text-align: center;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <img src="logo.png" alt="Riders Republic" class="logo">
            <h1>Soumettre une Run</h1>
        </header>

        <div class="player-info">
            Connecté en tant que : <span id="playerName">Non connecté</span>
        </div>

        <form id="submitForm">
            <div class="form-group">
                <label>Discipline</label>
                <select name="discipline" required id="disciplineSelect">
                    <option value="">Choisir une discipline</option>
                    <option value="bike">Vélo</option>
                    <option value="snow">Snow</option>
                    <option value="air">Air</option>
                </select>
            </div>

            <div class="form-group">
                <label>Épreuve</label>
                <select name="event" required id="eventSelect">
                    <option value="">Choisir d'abord une discipline</option>
                </select>
            </div>

            <div class="form-group">
                <label>Type de Record</label>
                <select name="recordType" required id="recordType">
                    <option value="score">Score</option>
                    <option value="time">Temps</option>
                </select>
            </div>

            <div class="form-group" id="scoreInput">
                <label>Score</label>
                <input type="number" name="score" min="0">
            </div>

            <div class="time-container" id="timeContainer">
                <div class="time-field">
                    <div class="time-label">H</div>
                    <input type="number" name="hours" min="0" max="23">
                </div>
                <div class="time-field">
                    <div class="time-label">M</div>
                    <input type="number" name="minutes" min="0" max="59">
                </div>
                <div class="time-field">
                    <div class="time-label">S</div>
                    <input type="number" name="seconds" min="0" max="59">
                </div>
                <div class="time-field">
                    <div class="time-label">MS</div>
                    <input type="number" name="milliseconds" min="0" max="999">
                </div>
            </div>

            <button type="submit">Soumettre</button>
        </form>

        <a href="index.html" class="back-link">← Retour aux classements</a>
    </div>

    <script>
        const events = {
            bike: [
                "Welcome to Riders", "The Giants", "Red Bull Holy Bike", "Don't Look Down", 
                "Diving Board", "Frontier", "Skrrt Skrrt", "Ridge TV Lucky Straight",
                "Sentinel Path", "A Nice Day Out…", "The Fissure Loop", "Liberty Cap Ride",
                "Red Bull Road Rage", "Watchman Trail", "Burnt Rubber", "Understeer",
                "Hoola Loop", "Santa Cruz Urban Ride", "Hospital Trail", "V-Loop",
                "The Swell", "Red Bull Hardline", "Lost in Sequoia", "Floor by Floor",
                "Xing", "Arrow Run", "Fox Racing Mtn. Rush", "Ford Foot Out"
            ],
            snow: [
                "Dreamline", "Spring Diet", "Pathfinder", "Red Bull Homerun",
                "Hold Your Breath", "Backbone", "Ice Edge", "8 Ball",
                "Ridge TV Multiball", "Killing Moon", "Dirty Hairy",
                "Bears On The Heels", "Ridge TV Snow Rush", "In Between The Line",
                "Trees To One Go!", "Rossignol Feel The Powder", "Back On Track",
                "For Real", "Elbow To Elbow", "Salomon All In One"
            ],
            air: [
                "Ridge TV The Dragonfly", "King Run", "In Between The Domes",
                "Hot Wings", "Migration", "Stream Rocket", "Rocket Congress",
                "Ridge TV Angels Flight", "8 Shape", "Dine and Dash", "Rocky Road",
                "Night Bird", "Canyon Loop", "Broken Wing", "Sunburn",
                "The Crest", "0 Faults", "Red Bull Aces"
            ]
        };

        // Mise à jour des épreuves selon la discipline
        document.getElementById('disciplineSelect').addEventListener('change', function() {
            const eventSelect = document.getElementById('eventSelect');
            eventSelect.innerHTML = '<option value="">Choisir une épreuve</option>';
            
            if (this.value && events[this.value]) {
                events[this.value].forEach(event => {
                    const option = document.createElement('option');
                    option.value = event;
                    option.textContent = event;
                    eventSelect.appendChild(option);
                });
            }
        });

        // Gestion de l'affichage score/temps
        document.getElementById('recordType').addEventListener('change', function() {
            const scoreInput = document.getElementById('scoreInput');
            const timeContainer = document.getElementById('timeContainer');
            
            if (this.value === 'time') {
                scoreInput.style.display = 'none';
                timeContainer.classList.add('visible');
            } else {
                scoreInput.style.display = 'block';
                timeContainer.classList.remove('visible');
            }
        });

        // Soumission du formulaire
        document.getElementById('submitForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            const data = {
                participant: document.getElementById('playerName').textContent,
                discipline: formData.get('discipline'),
                event: formData.get('event'),
                type: formData.get('recordType')
            };

            if (data.type === 'score') {
                data.value = formData.get('score');
            } else {
                // Convertir h/m/s/ms en millisecondes
                const h = parseInt(formData.get('hours')) || 0;
                const m = parseInt(formData.get('minutes')) || 0;
                const s = parseInt(formData.get('seconds')) || 0;
                const ms = parseInt(formData.get('milliseconds')) || 0;
                data.value = ((h * 3600 + m * 60 + s) * 1000 + ms).toString();
            }

            // Envoi vers Sheet.best
            fetch('https://api.sheetbest.com/sheets/c4d0a049-562b-4a08-9b1c-60631fcff8cf', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            })
            .then(response => {
                if (response.ok) {
                    alert('Run soumise avec succès !');
                    window.location.href = 'index.html';
                } else {
                    throw new Error('Erreur lors de la soumission');
                }
            })
            .catch(error => {
                alert('Erreur : ' + error.message);
            });
        });
    </script>
</body>
</html>